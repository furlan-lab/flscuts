% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{plot_grouped_geneset}
\alias{plot_grouped_geneset}
\title{Plot Grouped Geneset Scores}
\usage{
plot_grouped_geneset(
  cds,
  marker_set,
  name,
  by,
  fData_col = "gene_short_name",
  scale = "width",
  facet = NULL,
  adjust = 1.4,
  size = 0.05,
  alpha = 0.1,
  method = c("totals", "corrected"),
  overlay_violinandbox = TRUE,
  box_width = 0.3,
  rotate_x = TRUE,
  jitter = TRUE,
  return_values = FALSE
)
}
\arguments{
\item{cds}{A \code{cell_data_set} object from the \code{monocle3} package.}

\item{marker_set}{A character vector of gene identifiers corresponding to the genes in the geneset.}

\item{name}{A character string representing the name of the geneset (used as a label).}

\item{by}{A character string specifying the cell metadata column in \code{colData(cds)} to group cells by in the plot.}

\item{fData_col}{A character string specifying the feature data column in \code{rowData(cds)} that contains the gene identifiers in \code{marker_set}. Default is \code{"gene_short_name"}.}

\item{scale}{A character string specifying how violins should be scaled, passed to \code{\link[ggplot2]{geom_violin}}. Default is \code{"width"}.}

\item{facet}{A character string specifying an optional cell metadata column in \code{colData(cds)} to facet the plot by. Default is \code{NULL}.}

\item{adjust}{Numeric value for bandwidth adjustment in \code{geom_violin}. Default is \code{1.4}.}

\item{size}{Numeric value for point size in \code{geom_jitter}. Default is \code{0.05}.}

\item{alpha}{Numeric value for point transparency in \code{geom_jitter}. Default is \code{0.1}.}

\item{method}{A character string specifying the method to calculate geneset scores. Either \code{"totals"} or \code{"corrected"}. Default is \code{"totals"}.}

\item{overlay_violinandbox}{Logical indicating whether to overlay violin and box plots. Default is \code{TRUE}.}

\item{box_width}{Numeric value specifying the width of the boxplot. Default is \code{0.3}.}

\item{rotate_x}{Logical indicating whether to rotate x-axis labels by 90 degrees. Default is \code{TRUE}.}

\item{jitter}{Logical indicating whether to add jittered points to the plot. Default is \code{TRUE}.}

\item{return_values}{Logical indicating whether to return the plot and the scores data frame. If \code{FALSE}, only the plot is returned. Default is \code{FALSE}.}
}
\value{
If \code{return_values} is \code{TRUE}, a list with elements:
\describe{
  \item{\code{plot}}{The ggplot object.}
  \item{\code{scores}}{A data frame containing the geneset scores and grouping variables.}
}
If \code{return_values} is \code{FALSE}, only the ggplot object is returned.
}
\description{
Plots geneset scores for each single cell, grouped by a specified variable. The plot includes a violin plot, a boxplot, and optionally jittered points of the raw data.

Geneset scores are calculated per cell based on a set of genes. When using method \code{"totals"}, the sum of the size-factor corrected, log-normalized gene expression for the given set of genes is computed. When using method \code{"corrected"}, the geneset scores are corrected using 100 random genes with similar expression levels.
}
\examples{
# Assuming `cds` is a cell_data_set object, and `genes` is a vector of gene identifiers
# plot_grouped_geneset(cds, marker_set = genes, name = "MyGeneset", by = "cell_type")

}
\references{
Puram, S. V. et al. (2017). Single-Cell Transcriptomic Analysis of Primary and Metastatic Tumor Ecosystems in Head and Neck Cancer. \emph{Cell}, 171(7), 1611â€“1624.e24.
}
\keyword{internal}
