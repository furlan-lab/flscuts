% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/milo.R
\name{annotate_nhood}
\alias{annotate_nhood}
\title{Annotate Milo Neighborhoods with Cell Types}
\usage{
annotate_nhood(
  sce_milo,
  da_results,
  celltype_var,
  abundance_thresh = 0.7,
  plot = TRUE
)
}
\arguments{
\item{sce_milo}{A list containing a Milo object and a design matrix.}

\item{da_results}{A data frame of differential abundance results for the neighborhoods.}

\item{celltype_var}{Character string specifying the column in metadata containing cell type annotations.}

\item{abundance_thresh}{Numeric value specifying the minimum fraction threshold for a cell type to be considered dominant in a neighborhood. Default is 0.7.}

\item{plot}{Logical indicating whether to generate diagnostic plots. Default is TRUE.}
}
\value{
A list containing:
\describe{
  \item{milo}{The updated Milo object.}
  \item{da_results}{The annotated differential abundance results.}
  \item{design}{The design matrix used for differential testing.}
}
}
\description{
Annotates Milo neighborhoods with cell type information and filters neighborhoods based on abundance threshold.
}
\details{
This function annotates neighborhoods with cell type information, filters neighborhoods based on an abundance threshold, and optionally generates plots.
}
\examples{
# Example usage:
# result <- annotate_nhood(sce_milo, da_results, celltype_var = "cell_type")

}
