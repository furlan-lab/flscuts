% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/milo.R
\name{make_nhoods}
\alias{make_nhoods}
\title{Make Milo Neighborhoods from Seurat Object}
\usage{
make_nhoods(
  seu,
  assay = "RNA",
  k = 30,
  d = 30,
  prop = 0.1,
  variable = NULL,
  samples = NULL,
  covariate = NULL,
  plot = TRUE
)
}
\arguments{
\item{seu}{A Seurat object containing single-cell RNA-seq data.}

\item{assay}{Character string specifying the assay to use from the Seurat object. Default is "RNA".}

\item{k}{Integer specifying the number of nearest neighbors to compute in the k-NN graph. Default is 30.}

\item{d}{Integer specifying the number of dimensions to use from the PCA reduction. Default is 30.}

\item{prop}{Numeric value specifying the proportion of cells to include in each neighborhood. Default is 0.1.}

\item{variable}{Character string specifying the column in metadata by which to measure differential abundance.}

\item{samples}{Character string specifying the column in metadata representing samples or a primary covariate.}

\item{covariate}{Character string specifying the column in metadata representing batch or a secondary covariate.}

\item{plot}{Logical indicating whether to plot the neighborhood size histogram. Default is TRUE.}
}
\value{
A list containing:
\describe{
\item{milo}{A Milo object with neighborhoods constructed.}
\item{design}{A data frame representing the design matrix for differential testing.}
}
}
\description{
Constructs Milo neighborhoods from a Seurat object for differential abundance analysis.
}
\details{
This function converts a Seurat object into a SingleCellExperiment object, constructs Milo neighborhoods,
counts cells within neighborhoods, and prepares a design matrix for differential abundance testing.
}
\examples{
# Example usage:
# result <- make_nhoods(seu, variable="condition", samples="sample_id", covariate="batch")

}
